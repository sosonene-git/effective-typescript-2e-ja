# é …ç›®58  ã‚³ãƒ¼ãƒ‰ç”Ÿæˆã‚’è¤‡é›‘ãªå‹ã®ä»£æ›¿æ‰‹æ®µã¨ã—ã¦æ¤œè¨ã™ã‚‹

## è¦šãˆã¦ãŠãã¹ãã“ã¨

* å‹ãƒ¬ãƒ™ãƒ«ã®TypeScriptã¯éå¸¸ã«å¼·åŠ›ãªãƒ„ãƒ¼ãƒ«ã ãŒã€ãã‚ŒãŒå¸¸ã«æœ€é©ãªã‚ã‘ã§ã¯ãªã„ã€‚
* è¤‡é›‘ãªå‹ã®æ“ä½œã«ã¯ã€å‹ãƒ¬ãƒ™ãƒ«ã®ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãä»£ã‚ã‚Šã«ã€ã‚³ãƒ¼ãƒ‰ã¨å‹ã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ã‚’æ¤œè¨ã™ã‚‹ã€‚ã‚³ãƒ¼ãƒ‰ç”Ÿæˆãƒ„ãƒ¼ãƒ«ã¯ã€æ™®é€šã®TypeScriptã‚„ä»–ã®è¨€èªã§æ›¸ã‘ã‚‹ã€‚
* ç¶™ç¶šçš„ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ã‚¹ãƒ†ãƒ ä¸Šã§ã‚³ãƒ¼ãƒ‰ç”Ÿæˆã¨`git diff`ã‚’å®Ÿè¡Œã—ã€ç”Ÿæˆã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ãŒåŒæœŸã‚’ä¿ã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã€‚

## ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰

```ts
async function getBooks(db: Database) {
  const result = await db.query(
    `SELECT title, author, year, publisher FROM books`
  );
  return result.rows;
}
```

[ğŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/IYZwngdgxgBAZgV2gFwJYHsIwOYFNkBC66A1iABQAmARgFwwAiwyw1ouAlDAN4BQMMKJhDIYAJ1wgEAG1EBeGMADuwVKJoA6AI4JcYsOX4CYAAwDKAUQAyFgMIAVGGmTTcAGkUJkAC3RiPYLjA-jAADgjU0qgg3nowAGIASgDyALIw1MRkJkYcANxGEsgIYlgSUrIaYuhKIAUAvkA)

----

```ts
async function getLatestBookByAuthor(db: Database, publisher: string) {
  const result = await db.query(
    `SELECT author, MAX(year) FROM books GROUP BY author WHERE publisher=$1`,
    [publisher]
  );
  return result.rows;
}
```

[ğŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/IYZwngdgxgBAZgV2gFwJYHsIwOYFNkAywyuIyAQuugNblgCCCyAFugE4AUAJgEYBcMACLFgPULgA0MAA4IeAG1QhmuNgLJtUEbAEoYAbwBQMGFExkYbUgnnIYAXhjAA7sFR3eAOgCOCVWA5jExgAAwBlAFECCIBhABUnJlY2KQBZegANDjBcYDY9ADEAJQB5VJgeKmoQGABxUoBVAAUYcgBNRJZ2GAB1AAkIooiZOUVlVXsAEgBGEIkgkwBtWQUlFTYAXSCdAG4gq2QENiwrEBtkTzZ0ZxA9gF8gA)

----

```ts
import { sql } from '@pgtyped/runtime';
const selectLatest = sql`
    SELECT author, MAX(year)
    FROM books
    GROUP BY author
    WHERE publisher=$publisher
`;

async function getLatestBookByAuthor(db: Database, publisher: string) {
  const result = await selectLatest.run({publisher}, db);
  //    ^? const result: any[]
  return result;
}
```

[ğŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/JYWwDg9gTgLgBAbzgZwI4Bs4F84DMoQhwDkAAmAOYwCeYApgCYD0UArgHYyh3EDcAUAGMI7ZPGR10dQTAAyAQxh0xcALwoMAA35xdcAMoBRWYYDCAFTjzWMABbQANHACyAQQAaACmp15UAJQ6egBiAEoA8s5wAEYQEADWyEG6AOIRAKoACnAAQgCaVjb2UMlwAOoAEoahhnBgrNHowMi2dFCqACT1jc2tJZoC-PLI1OyCeBwywCJwFHRyisowOXHxOdSuRdCeDNEAXHAAIory0cN0Tt1NLW0HYlDA7BT+iEHCovBQyqzo8OryAHd5MBxJJpAslGIAHRsdieBBXXptLBOXb+AS6JhMPRwAB6AH44O8VF9kD8YAd5OxqABtAC6QS+MFYUHYcFJ5IEWCAA)

----

```ts
/** Types generated for queries found in "books-queries.ts" */

/** 'selectLatest' parameters type */
export interface selectLatestParams {
  publisher: string;
}

/** 'selectLatest' return type */
export interface selectLatestResult {
  author: string;
  year: number;
}

/** 'selectLatest' query type */
export interface selectLatestQuery {
  params: selectLatestParams;
  result: selectLatestResult;
}
```

[ğŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/PQKhAIBUE8AcFMDO4Dm8B28BOBDALvACbgBmA9luAI4Cu2AlkqWTesfeuAEQBGZZAa0QBaWgyQA6PIi7gQwAFALQEAOSJ4AG3gBjPABl8SPKvCwcuALbwCWZHjjw5i+AA9YFPOA62SOHU4a2nqGBIh4AAoWOJbIAN4K4GY0PJr0iAAW2ABc4OFYHCgA3AoAvkoq4OpaugZG4aZYNjRYnA4IzgpuHlhePth+AXk1IfV4AEpINJpeCUk4NHgZFLn5hSVJ0PAWueg0ljzYJeXKYFVBtaHGpmJY0ODtTvJd7p7e6L7+gSN1YXgAinQ7uA5mZorFVj8ruEolZEBtwE1ENM8JDgr9jJNkTNjkA)

----

```ts
import { sql } from '@pgtyped/runtime';
import { selectLatestQuery } from './books-queries.types';
export const selectLatestBookByAuthor = sql<selectLatestQuery>`
    SELECT author, MAX(year)
    FROM books
    GROUP BY author
    WHERE publisher=$publisher
`;

async function getLatestBookByAuthor(db: Database, publisher: string) {
  const result = await selectLatestBookByAuthor.run({publisher}, db);
  //    ^? const result: selectLatestResult[]
  return result;
}
```

[ğŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/JYWwDg9gTgLgBAbzgZwI4Bs4F84DMoQhwDkAAmAOYwCeYApgCYD0UArgHYyh3EDcAUKEixEKOujoBjGABkAhjDrIYARVZ0o1bHgJFiAOiYAjCBADWyALSp1UYEv016yPvzoAPYfEkR2ysRLS8orKAEKmZqHUAIKsMAAW0HAAvCgYADzI4lKyCkqqttQAfAAG-HAVcADKAKIyNQDCACpwcnGJUAA0cACy0QAaABTUdHJQAJTllQBiAEoA8j1wJubIUxUA4gsAqgAKcKEAmq3t0OtwAOoAEjWzNXBgrEbowMjxGskAJI-Pr+9Q-BKAn4cmQ1HYkjwHGkwF8cAodFyIRg4XMUViCWggwYRgAXHAACIKORGUF0bo-F5vDT45R2dgUcaIKY+PzwKBKVjoeCpOQAdzkwHgWUCSPyqMiMVOUH0bHYgwQlL+Giw3Rx4wEFSYTEqcAAegB+OCs-wc5BcmC07JBPLKWac7kAbQAulMOTBWFB2HAzRaBFggA)
