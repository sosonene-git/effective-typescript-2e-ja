# é …ç›®70  åž‹ã‚’éƒ¨åˆ†çš„ã«ã‚³ãƒ”ãƒ¼ã—ã¦ä¾å­˜ã‚’æ–­ã¡åˆ‡ã‚‹

## è¦šãˆã¦ãŠãã¹ãã“ã¨

* å…¬é–‹ã™ã‚‹npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã¯ã€åž‹ã®æŽ¨ç§»çš„ä¾å­˜é–¢ä¿‚ã‚’é¿ã‘ã‚‹ã€‚
* æ§‹é€ çš„åž‹ä»˜ã‘ã‚’ä½¿ã£ã¦æœ¬è³ªçš„ã§ãªã„ä¾å­˜ã‚’æ–­ã¡åˆ‡ã‚‹ã€‚
* JavaScriptãƒ¦ãƒ¼ã‚¶ãƒ¼ã«`@types`ã¸ã®ä¾å­˜ã‚’å¼·åˆ¶ã—ãªã„ã€‚Webé–‹ç™ºè€…ã«Node.jsã¸ã®ä¾å­˜ã‚’å¼·åˆ¶ã—ãªã„ã€‚

## ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰

```ts
import {Buffer} from 'node:buffer';

function parseCSV(contents: string | Buffer): {[column: string]: string}[]  {
  if (typeof contents === 'object') {
    // Bufferã®å ´åˆ
    return parseCSV(contents.toString('utf8'));
  }
  // ...
}
```

[ðŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/JYWwDg9gTgLgBAbwEIFcBmaCmUC+c1QQhwDkAdhACaYBcARullCQNwBQbaKZAxjMBDJwwAQygBnTAGEAygDUAFD0ExMZGOJpxxMKMDIBzOAB84qDNgCUWhAG1lAGxQgyWnXsMBdN7v0Gctp5wiGzBwGhwCjAAnmCYEBHK6moacAC8GaQQdABWmHwkliHBwQD0pWaM2IB2DIAsGoAQKqElUJgwKFBCohLS8koqKeIAdDAQMr6GCiQoMGgAHIWW7ME4TeVwgxtsOEA)

----

```ts
import { Buffer } from 'node:buffer';
export declare function parseCSV(contents: string | Buffer): {
    [column: string]: string;
}[];
```

[ðŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/JYWwDg9gTgLgBAbzgIQK4DN0FMpwL5zpQQhwDkAdhACZYBcARhtlGQNwBQWAHpLHLQDGAGwCGULIVQVBMYBApww4gM5YAwgGUAagApBCmFgowVdOCphRgFAOZwAPimY4AlOYQc43uAG0DwqggFOaW1nYAuqFWNraceL4RbEA)

----

```ts
export interface CsvBuffer {
  toString(encoding?: string): string;
}
export function parseCSV(
  contents: string | CsvBuffer
): {[column: string]: string}[]  {
  // ...
}
```

[ðŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/KYDwDg9gTgLgBASwHY2FAZgQwMbDgYQGcA3AIQFd1004BvAKDjhggGUYpkBzACmCWwQAJtwD8ALjiEO3AJSTpnJFwDc9AL71QkWHHTkBMBBCRwwmKIWD5WANR6M4glPxiEFM5XAA+BEhSo0enk6AG1BABtyAFskDyUuAF147nVQxKYGJgB6bLgAOkKNIA)

----

```ts
parseCSV(new Buffer("column1,column2\nval1,val2", "utf-8"));  // OK
```

[ðŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/A4QwTgzgpgwgygNQBQDsoHcAEAhArgM3yjCQCIBjAewBtcBbFARgBoraGAmAHRQDcRqLftQ6lmmUrgAu+ALQAOUgEolAbkyYA9JswB5ANJA)

----

```ts
/** Node.jsã®Bufferã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãªã©ã€ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’æŒ‡å®šã—ã¦stringã«å¤‰æ›ã§ãã‚‹ä½•ã‹ */
export interface StringEncodable {
  toString(encoding?: string): string;
}
```

[ðŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/PQKhAIDkHsBMFMB0ArAzoOwYBCBXAZr+AJ0CqGQNYZAOhkHKGQeoZAJhkCsGQSwZBABkAqGQZ4ZBmhkB+GQSYZAkhkDgxoCztQOoMgMwZUAF0IBLAHYBzQNYMgSE1A28aBzBkCyDIGiGQKrygaQZwIYACh4ADwAO0QlPAKpRXAEMAxvHABlGQsUAovLucK4ARgA2XgDeZuDgUtC+ckoAFPDBcP4A-ABc4NIpigCU+YX+ANxmAL5AA)

----

```ts
import {Buffer} from 'node:buffer';
import {parseCSV} from './parse-csv';

test('parse CSV in a buffer', () => {
  expect(
    parseCSV(new Buffer("column1,column2\nval1,val2", "utf-8"))
  ).toEqual(
    [{column1: 'val1', column2: 'val2'}]
  );
});
```

[ðŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/JYWwDg9gTgLgBAbwEIFcBmaCmUC+c1QQhwDkAdhACaYBcARullCQNwBQoksiYAhlAGdMAYQDKANTwEipAHQB6PoMwBaAMYCAbqzZsYmATAAUJJULhjxcYGTi84DDNhIAaOEYCUcALwA+RGxwcJgAHmCYasaBQXBmIhJGZJgA7nCoTlBGAERqEAA2KCBkAIwuuQVFAEwAOmSavHml9XmVWW5ZKDBoKgAcWR4e0R6yMBAAogCOKA1G0UEA2gjlhSU0pM3FrnDLVWskzZUkOAC6Q+w4HixAA)
