# é …ç›®26  é–¢æ•°åž‹ã®æ¨™æº–APIã‚„ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦åž‹ã®æµã‚Œã‚’ä¿ƒé€²ã™ã‚‹

## è¦šãˆã¦ãŠãã¹ãã“ã¨

* åž‹ã®æµã‚Œã‚’ä¿ƒé€²ã—ã€å¯èª­æ€§ã‚’é«˜ã‚ã€å¿…è¦ãªåž‹ã‚¢ãƒŽãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ¸›ã‚‰ã™ãŸã‚ã€æ‰‹æ›¸ãã®ãƒ«ãƒ¼ãƒ—ã®ä»£ã‚ã‚Šã«é–¢æ•°åž‹ã®æ¨™æº–APIã‚„Lodashã®ã‚ˆã†ãªãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã™ã‚‹ã€‚

## ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰

```js
const csvData = "...";
const rawRows = csvData.split('\n');
const headers = rawRows[0].split(',');

const rows = rawRows.slice(1).map((rowStr) => {
  const row = {};
  rowStr.split(",").forEach((val, j) => {
    row[headers[j]] = val;
  });
  return row;
});
```

[ðŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/MYewdgzgLgBMEDcAiBDKKYF4YCIB0BOA3AFCiSwBOKA7gEog0RZyKrp4QAOANgJZQAFAHIAOmGEBKUuWgwAFgFMUAE0WVm2avUYQA2gAYAup14CRAGimky4OZV0ttDJp37BFggIyS8AWxQuQUEHGgBlKEpJLAA+GABvEhg4OypGFniAX1Jk0IjKU34hHAscXwAzEEoAURRgeWCEFB4LGAAraMw4xOTcxj0lVXV9NqMjFiaeHJhM6SSYSkUoAFdKMAXGUlmiIA)

----

```js
const rows = rawRows.slice(1)
  .map((rowStr) =>
    rowStr
      .split(",")
      .reduce((row, val, i) => ((row[headers[i]] = val), row), {})
  );
```

[ðŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/MYewdgzgLgBATiA7hGBeeBDRAlJEB0EANgJbACmAFAIwCUAUDDPgLYYAOllCiAylHFpoAfIybwk-OGPHMI7UlEoAiADTKGspvjjkAJgFcKXHqpgA3DETMkhqYTBNIA2gAtyGPeTgRnJALr+aBZWtGY8YTAA3gC+mjC0ANxAA)

----

```ts
import _ from 'lodash';
const rows = rawRows.slice(1)
    .map(rowStr => _.zipObject(headers, rowStr.split(',')));
```

[ðŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/JYWwDg9gTgLgBAfTgMyhEcDkAbCATAQwGcALTAbgCgBjCAOyPjQHci4BeOKA5gJQlYA6ItmDUApgAoAjAEpKcRXEEgCYSSwDKMKBwB8iQQC9gYAPIAjAFbjqMSSXEE84qEQA0XAdqjCwo+0x3TFlQ8iA)

----

```ts
const rowsImperative = rawRows.slice(1).map(rowStr => {
  const row = {};
  rowStr.split(',').forEach((val, j) => {
    row[headers[j]] = val;
    // ~~~~~~~~~~~~ No index signature with a parameter of
    //              type 'string' was found on type '{}'
    //              åž‹ 'string' ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’æŒã¤ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
    //              ã‚·ã‚°ãƒãƒãƒ£ãŒåž‹ '{}' ã«è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚
  });
  return row;
});
const rowsFunctional = rawRows.slice(1)
  .map((rowStr) =>
    rowStr
      .split(",")
      .reduce(
        (row, val, i) => ((row[headers[i]] = val), row),
        //                 ~~~~~~~~~~~~~~~ No index signature with a parameter of
        //                                 type 'string' was found on type '{}'
        //                                 åž‹ 'string' ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’æŒã¤ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
        //                                 ã‚·ã‚°ãƒãƒãƒ£ãŒåž‹ '{}' ã«è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚
        {}
      )
  );
```

[ðŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/MYewdgzgLgBATiA7hAkgWwA4FM4EMoCWAbljALzy6IBKSEAdBADYHBYAUAjAJT1q4Z2CRAGUoccgD4YAbwBQMGKEixh5WQF8A3AvhIxcRhhZR2AcgA0Z3gDMQcAKK5gAC3bsiuJhZgArblKyuorCANouWLgAJjgQob4Augnqnkw6iooA9JkwAH75BYX5MAByIDAEYDEAHjAQBADmYPgArnCkiARQLjC4MBi4eGhYUDgwIDbBMNkZs3OKUACe2DBm0HCVDWYwiLgQMHYtVeNgMEsrZjIaZlMz8-eA0eqr65vbgHYMgIsMgJcMgIcMgD8MgH6GP6AJIZAIDGgBMGQAlDIBnhkA4wyAYYZAPUMgE6GW45e7zQDtDIAGhkAswyAQYZAMcMgBkGJ6Xa4wQDWDIBoyPBgGkGQBRDIA-BkA2gyAZIZAOYMgHUGQD6DIAgBl0Gm46XgIzap2EOiFOmU0D0yAAYkdgIRwF51HgaHRGCw2FxuLo+AJ3MIDAEyJIpqbxFNFEYTOwAEQWR0G+b0dpRFp620ZIRIHypHwEc3SE1IcKRGJwOIEJIpLzcHzCJO+rLojH3IrZwqlcqVGp1RrNKBtDpdHp9AZDEZjCZp6YZzPNlvnUhrcSvHZ7A4gI5RE5nZbtq43DF3FuTjFkl5gLYwT6-QEgiEwhEohsTqfbjI4gkksmjqm0xmszm8gUYq6+t0wYVAA)

----

```ts
const rowsLodash =
  rawRows.slice(1).map(rowStr => _.zipObject(headers, rowStr.split(',')));
rowsLodash
// ^? const rowsLodash: _.Dictionary<string>[]
```

[ðŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/MYewdgzgLgBATiA7hAMiAJgQwgCxgXgCgZ5NEAlJCAOggBsBLYAUwAoBGASmoFtMAHVgkQBlKHAIA+GAH1qALwb8A8gCMAVs2BRWOZpnTM4EADTwkYuLX6MdAchN3OzgNyFhqDNhyEA9L5gAPQB+GFBIWA80LFwALllqABEmKAZwTDgATwAeaDgGMABzSQBtAF0gA)

----

```ts
interface BasketballPlayer {
  name: string;
  team: string;
  salary: number;
}
declare const rosters: {[team: string]: BasketballPlayer[]};
```

[ðŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/JYOwLgpgTgZghgYwgAgEJwM4GsJgEZwA2hACoXAJ7TIDeAUMsiHALYQBcyGYUoA5gG4GySK07deIQcIxE4UCpxABXFnmhCAvnQAmEBOSgoEAexDdkUE92gZONANqiW4nvwC6ndNlwFiZSmgHd00BIA)

----

```ts
let allPlayers = [];
//  ~~~~~~~~~~ Variable 'allPlayers' implicitly has type 'any[]'
//             in some locations where its type cannot be determined
//             å¤‰æ•° 'allPlayers' ã¯ã€åž‹ã‚’æ±ºå®šã§ããªã„ä¸€éƒ¨ã®å ´æ‰€ã§ã¯ã€
//             æš—é»™ã®ã†ã¡ã« 'any[]' åž‹ã«ãªã‚Šã¾ã™ã€‚
for (const players of Object.values(rosters)) {
  allPlayers = allPlayers.concat(players);
  //           ~~~~~~~~~~ Variable 'allPlayers' implicitly has an 'any[]' type
  //                      å¤‰æ•° 'allPlayers' ã®åž‹ã¯æš—é»™çš„ã« 'any[]' ã«ãªã‚Šã¾ã™ã€‚
}
```

[ðŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/DYUwLgBAhswArCgTxAJwM4QLwQNoF0BuAKAHpSIIA-G2uiANSlQEsoAjUCAchnkRQZuEFgFsADsBYBjFmGBIIACyiYwScSB5QAdkgLcyFSidMmWOiOgD2orcGvSoYFtZ2YA7krRa5ajVpOOjrWkOxaACbgaKIWIBFGZkmUgJCagA6m2rAIyGjowoD2DICADIDR6oBJDIBeNoBZ2oDmDICyDIBWDIAiDIAAcoAXCYB2DIAsGoACRtVFiclmgOlmgJt57YBiDICGDIDWDNp6BhDF0-WAUQyAfgyAmgyAQAzEAGbWqBAAFNJu6JCSORgQ1rsQAPLsAFYg0mAAdABuMACuIOhHVDWc65ACUoIgAG9iJQ+NlBJgcHCBLl3qcdE4wEdLgjQSRKORBiY6CSqIxmGxOFpeFkUUIRBIpLJ5IoVJhdHN9PhhOpNDCIISiULUhkafwrnkIO1ivlRoAQt1mvHm3Igy3W22IAF8gA)

----

```ts
let allPlayers: BasketballPlayer[] = [];
for (const players of Object.values(rosters)) {
  allPlayers = allPlayers.concat(players);  // OK
}
```

[ðŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/DYUwLgBAhswArCgTxAJwM4C4ICEroGtwAjGeRFVAbQF0IBeCWgbgCgAzAe1QgAoBjTgDt0kAA4U06CJ3YQA8sQBWIfmAB0ANxgBXEOl6pOoqQEpTEAN6sI0WAmRSGd8o4zrBQ-lDC8Jb9FNmWwB6EIUAaVYAXyA)

----

```ts
const allPlayers = Object.values(rosters).flat(); // OK
//    ^? const allPlayers: BasketballPlayer[]
```

[ðŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/MYewdgzgLgBAhgGwQBQXAngUwE4RgXhgHkAjAK02CgDoA3RAV0wgApsRocIBKagMzRQW3ANwwA9OOIBpAFCSYimAD0A-DFCRYiFGiy4AXDABCcCAGtMUEjtQYcAbQC6QA)

----

```ts
const teamToPlayers: {[team: string]: BasketballPlayer[]} = {};
for (const player of allPlayers) {
  const {team} = player;
  teamToPlayers[team] = teamToPlayers[team] || [];
  teamToPlayers[team].push(player);
}

for (const players of Object.values(teamToPlayers)) {
  players.sort((a, b) => b.salary - a.salary);
}

const bestPaid = Object.values(teamToPlayers).map(players => players[0]);
bestPaid.sort((playerA, playerB) => playerB.salary - playerA.salary);
console.log(bestPaid);
```

[ðŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/MYewdgzgLgBFCmBDAtgFRABQDaIJ7wCcIAuGAbwG0EVToCBLMAcwF1SAhRCAa3igCNEWLNjyEKLAL4wAvOUkBuAFAAzEARgAKUJFgAHHPg0gVMISMOEIASnJKYMHdHLVk0uQbEFlD1+lFGEFRIyCyycCH+lkTBKGEAPvEwEj4RKFFeQa4sAHR6AK4QABaankbWypJKqupaTvrREDAmMADy-ABW8MBQOQBuQvnwEJp+mI3WtmT2MGVWORDqUJqaiAA0MPy2MgB8mwtCiAS4MAC0Zgc4xxVKVUr1m8NQGIj0ACbh7V09-YPDo5FxplrDlkIg9KVGrI9nMYgAGFg3fhPF7vBZLFawgCCG1h7G2MOi7EuRxO52xJOuyicICw8ByWBATE0yOgqLeFSAA)

----

```ts
const bestPaid = _(allPlayers)
  .groupBy(player => player.team)
  .mapValues(players => _.maxBy(players, p => p.salary)!)
  .values()
  .sortBy(p => -p.salary)
  .value();
console.log(bestPaid);
//          ^? const bestPaid: BasketballPlayer[]
```

[ðŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/MYewdgzgLgBARgU2gBQIYEsAmMC8MD6AFKgDYnImoCeCAThAJQBQMMAdAOa0gCuADgCEqhPpRq1cAPhijqdNlASoAts1ZtlqPgDVSPJCLF0IUghtQAPIYbn0ANDNN82EUqlpUGAQjXsAbnoGvi4gtFDWfKYAtM6ulB7BAST6hAwA3EygkCAkCGwkIByEiCgYmOlMAPSVrLV1MAB6APwwWdDwSFBoWABcMAKoEADWCFBwpORGtADaALpAA)
