# é …ç›®62  ãƒ¬ã‚¹ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã¨ã‚¿ãƒ—ãƒ«å‹ã‚’ä½¿ã£ã¦ã€å¯å¤‰é•·å¼•æ•°ã®é–¢æ•°ã‚’ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã™ã‚‹

## è¦šãˆã¦ãŠãã¹ãã“ã¨

* ã‚·ã‚°ãƒãƒãƒ£ãŒå¼•æ•°ã®å‹ã«ä¾å­˜ã™ã‚‹é–¢æ•°ã‚’ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã™ã‚‹ãŸã‚ã«ã€ãƒ¬ã‚¹ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã¨ã‚¿ãƒ—ãƒ«å‹ã‚’ä½¿ç”¨ã™ã‚‹ã€‚
* ã‚ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®å‹ã¨ã€ãã‚Œä»¥å¤–ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®æ•°ã¨å‹ã®é–¢ä¿‚ã‚’ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã™ã‚‹ã«ã¯ã€æ¡ä»¶å‹ã‚’ä½¿ç”¨ã™ã‚‹ã€‚
* å‘¼ã³å‡ºã—å…ƒã«åˆ†ã‹ã‚Šã‚„ã™ã„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼åã‚’è¡¨ç¤ºã§ãã‚‹ã‚ˆã†ã€ã‚¿ãƒ—ãƒ«å‹ã®è¦ç´ ã«å¿˜ã‚Œãšã«ãƒ©ãƒ™ãƒ«ã‚’ä»˜ã‘ã‚‹ã€‚

## ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰

```ts
interface RouteQueryParams {
  '/': null,
  '/search': { query: string; language?: string; }
  // ...
}
```

[ğŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/JYOwLgpgTgZghgYwgAgEoHsCukCKnoCeACnFHALYDOyA3gFDLIDkA9EwFzIiYA2PANA2YtKEUggAWHWsgCO+KAU6UwUUAHMA3Mh5wQ6zHHUQA-MtUbtAXyEsWyAHRO6VoA)

----

```ts
function buildURL(route: keyof RouteQueryParams, params?: any) {
  return route + (params ? `?${new URLSearchParams(params)}` : '');
}

console.log(buildURL('/search', {query: 'do a barrel roll', language: 'en'}))
console.log(buildURL('/'))
```

[ğŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/GYVwdgxgLglg9mABAIxDANgEwKoCUAyAFAE5whQCmAXIgNYUCecwiuZlAiiBcQwAoBDYgIC2AZwA0iAA5DRYgPw0BYBgEpEAbwBQiRMQpQQxJKXIVEAakSFZw8YgWIABgoAkmsBQDuiPPgBlCiEIAAtBezFbOXE1AF9nRBoAcmS1AG5tOO1tCAQxOHQKADp0OABzQlQMHAJCZIB6MWDiMOSpTQBHbl4UzDhEARQhA3R9QvR2xHQVcpABcupEZIowZLi1NVz8wpKyyuqsf3qGtLUgA)

----

```ts
buildURL('/', {query: 'recursion'});  // ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã¹ã
                                      // ï¼ˆãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã¯ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’å–ã‚‰ãªã„ï¼‰
buildURL('/search');  // ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã¹ãï¼ˆå¿…è¦ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ãŒãªã„ï¼‰
```

[ğŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/EYVwlgNgJgqgSgGQBQHID0KA0ACA3gRxAFMAnATwC5sUSiBjEEgZzAHsA7FAXwEoBubNjRpsgCoZAlwyAfhkDWDICsGQNEMgTwZAsgwAoQRs1btO3RuHZAEP+AJhkDDDIHWGQFsMkwB0MgewZAiwzjAhwyTA-QyTASQyA15UCRDLMARBkBIf9VQSFhEVDQmIgBDEjoACxR+QQMJGQUVQ0BR-UBAyNknVw9AGQZAoKA)

----

```ts
function buildURL<Path extends keyof RouteQueryParams>(
  route: Path,
  params: RouteQueryParams[Path]
) {
  return route + (params ? `?${new URLSearchParams(params)}` : '');
}
```

[ğŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/GYVwdgxgLglg9mABAIxDANgEwKoCUAyAPAAoCGUAFogKYAeU1YmAzogNbUCecwiucIBgEUQ1AE6cyY0gFtmAPgAUAKESIxAhgC5EZSgBpViAA6lpcnf0HUR4yWdnMA2nooBdZQEpEAbyNjqKBAxJA1rRABqREVTc1YAfkQAA3iAEh8wagB3RDx8AGVqMwgKKUcYhzlPAF8kxB0AcgbPAG5laqA)

----

```ts
buildURL('/search', {query: 'do a barrel roll'})
buildURL('/search', {query: 'do a barrel roll', language: 'en'})
buildURL('/search', {})
//                  ~~ Property 'query' is missing in type '{}' ...
//                     ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ 'query' ã¯å‹ '{}' ã«ã‚ã‚Šã¾ã›ã‚“...
```

[ğŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/EYVwlgNgJgqgSgGQBQHID0BnApgQwE4DGAFigDQAEA3gI4hZ4CeAXOSlAPbk7nD55YRyedhAgoAvgEoAUKEixEqTLkIkKNOoxZtO3Xnn6DhosuQg4AdgHMQOK1m1YLEmXOjxk6bPmKnKU6TQ0chDQsPDQgD9I8gAFYQAHegAXBlZaegYUcjAMcgBbXIwwaxyLclSk1n9sgDp6wOCI5ubAdYZAW4ZARYZAMYZAYoZ0zSzyQHsGQGj1avFswGsGQCEGQCiGQD8GQG0GQGSGetqgA)

----

```ts
buildURL('/', {query: 'recursion'});  // ã‚¨ãƒ©ãƒ¼ã€ãƒ¨ã‚·ï¼
//            ~~~~~~~~~~~~~~~~~~~~ Argument of type '{ query: string; }' is
//                                 not assignable to parameter of type 'null'
//                                 å‹ '{ query: string; }' ã®å¼•æ•°ã‚’å‹ 'null' ã®
//                                 ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã«å‰²ã‚Šå½“ã¦ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚
buildURL('/', null);  // OK
buildURL('/');  // ã“ã‚ŒãŒè¨±å¯ã•ã‚Œã¦ã»ã—ã„
// ~~~~~ Expected 2 arguments, but got 1.
//       2 å€‹ã®å¼•æ•°ãŒå¿…è¦ã§ã™ãŒã€1 å€‹æŒ‡å®šã•ã‚Œã¾ã—ãŸã€‚
```

[ğŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/EYVwlgNgJgqgSgGQBQHID0KA0ACA3gRxAFMAnATwC5sUSiBjEEgZzAHsA7FAXwEoBubNjRpsgCoZAlwyAfhkCADIAuGQO0MgQH+AUMMHqN6gH47de-fuwBBEgHMQAWyLsALtlYAzbDbIAHItVzZCpStiY2JGDspgJcKNhgTKoimnHxCXHsrHYAhkwspuypwBAeNqzYrqkkqVY2pPZOLu7U7CAQECgxia1t6oDR6p7exORUAUEhYRGAdgyAqPqADqaASQxdKPWNoy3ty-GAiwzigIcMkoD9DJKA1gyATkqAUQyAyvqAZgyA0QyAygyAFgyA9gyA5gyAsgyAfgyA2gyAyQyAQAzKoJCwiFQGBw8wg-EEagA8gBpX7gaDwZDoFDgoQiK6AGIZADIMgEYowD3yoBVBgxZ0A3gyAdQZACIMLUMAFEAB7uOgVKDYABM2BK5istiYOFAdlMKWwAEYAHRLTTswDQCuMJljAKP6gEDIh6ATQYsdJhdgpYBwY0AWdpEl5kwD6DF8gA)

----

```ts
function buildURL<Path extends keyof RouteQueryParams>(
  route: Path,
  ...args: (
      RouteQueryParams[Path] extends null
      ? []
      : [params: RouteQueryParams[Path]]
    )
) {
  const params = args[0];
  return route + (params ? `?${new URLSearchParams(params)}` : '');
}
```

[ğŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/GYVwdgxgLglg9mABAIxDANgEwKoCUAyAPAAoCGUAFogKYAeU1YmAzogNbUCecwiucIBgEUQ1AE6cyY0gFtmAPgAUAKESIxAhgC5EZSgBpViAHSnSYgObMdKtXb6bqI8ZPOzmAbT0UAujXqMLIhgIOjoRvYA-IgePhF2Oh4ADm5yOvyCTqISUu5e5L5x9gCUysWIAN5GEAjMUIgp0nKIALyI5lYeAAw+ANxGYtRQIGJIGpmIANSIio3uiNEABpEAJBVg1ADuiHj4AMrU5hAUuXKzqczFAL6LiDoA5PfF-VdAA)

----

```ts
buildURL('/search', {query: 'do a barrel roll'})
buildURL('/search', {query: 'do a barrel roll', language: 'en'})
buildURL('/search', {})
//                  ~~ Property 'query' is missing in type '{}' ...
//                     ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ 'query' ã¯å‹ '{}' ã«ã‚ã‚Šã¾ã›ã‚“...

buildURL('/', {query: 'recursion'});
//            ~~~~~~~~~~~~~~~~~~~~ Expected 1 arguments, but got 2.
//                                 1 å€‹ã®å¼•æ•°ãŒå¿…è¦ã§ã™ãŒã€2 å€‹æŒ‡å®šã•ã‚Œã¾ã—ãŸã€‚
buildURL('/', null);
//            ~~~~ Expected 1 arguments, but got 2.
//                 1 å€‹ã®å¼•æ•°ãŒå¿…è¦ã§ã™ãŒã€2 å€‹æŒ‡å®šã•ã‚Œã¾ã—ãŸã€‚
buildURL('/');  // OK
```

[ğŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/EYVwlgNgJgqgSgGQBQHID0BnApgQwE4DGAFigDQAEA3gI4hZ4CeAXOSlAPbk7nD55YRyedhAgoAvgEoAUKEixEqTLkIkKNOoxZtO3Xnn6DhosuQg4AdgHMQOK1m1YLEmXOjxk6bPmKnKU6TQ0chDQsPDQgD9I8gAFYQAHegAXBlZaegYUcjAMcgBbXIwwaxyLclSk1n9sgDp6wOCI5ubAdYZAW4ZARYZAMYZAYoZ0zSzyQHsGQGj1avFswGsGQCEGQCiGQD8GQG0GQGSGetrpWXB3RXQ-DK1WfgIQPGL2ZykAbkaWsOiHx6fn8gBRAA8kgmSsKHIARi4eBs+ScyQwFFAyXIVnY0IATBsgncUajQoDANAKgDsGQCo+oAHU0AMgyAUf1AIGRgHMGQCaDATAIAM8PIGMA4MaALO1AKoMgBiGBaAdQZAPoMgCAGLbyDxKUwWECiSQ3ZGox5vT5Yb6-AFAkFgiE8EDQ2EIpFNNHo+m4wmkyk0umM1kcnn8twKTxoFASkLIgDyAGkgA)

----

```ts
buildURL('/');
// ^? function buildURL<"/">(route: "/"): string
buildURL('/search', {query: 'do a barrel roll'})
// ^? function buildURL<"/search">(
//      route: "/search", params: { query: string; language?: string; }
//    ): string
```

[ğŸ’» TypeScriptãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](https://www.typescriptlang.org/ja/play/?ts=5.8.2#code/EYVwlgNgJgqgSgGQBQHID0KCUBuAUGtAAgD0B+QgMxADsBjAFzAHtrDRJZEAeAIjR4B8SAE5MQ9AKYAuQnx6YZAZ3rCw1AOa520eMnSKJAQ2G0AFigA0hAN4BHEBOEBPGSihNChtseESIhUQgIFABfTHwiMkoaBmZWbU4EXjQDYzNBJAjCbJzRcWlZFKMTUx4rAAdjQwBbRRlrQntHF0JlVQ1sQghDDRBDdQlSJRU1dU6QrJyFVpGNIA)
